const me=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}};me();function P(){}function le(t){return t()}function te(){return Object.create(null)}function L(t){t.forEach(le)}function _e(t){return typeof t=="function"}function D(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let O;function ne(t,e){return O||(O=document.createElement("a")),O.href=e,t===O.href}function he(t){return Object.keys(t).length===0}function m(t,e){t.appendChild(e)}function g(t,e,n){t.insertBefore(e,n||null)}function y(t){t.parentNode.removeChild(t)}function p(t){return document.createElement(t)}function j(t){return document.createTextNode(t)}function k(){return j(" ")}function B(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function d(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function ye(t){return Array.from(t.childNodes)}function A(t,e){t.value=e==null?"":e}function ge(t,e,n,s){n===null?t.style.removeProperty(e):t.style.setProperty(e,n,s?"important":"")}let G;function T(t){G=t}const S=[],se=[],x=[],re=[],be=Promise.resolve();let J=!1;function $e(){J||(J=!0,be.then(oe))}function M(t){x.push(t)}const H=new Set;let C=0;function oe(){const t=G;do{for(;C<S.length;){const e=S[C];C++,T(e),ve(e.$$)}for(T(null),S.length=0,C=0;se.length;)se.pop()();for(let e=0;e<x.length;e+=1){const n=x[e];H.has(n)||(H.add(n),n())}x.length=0}while(S.length);for(;re.length;)re.pop()();J=!1,H.clear(),T(t)}function ve(t){if(t.fragment!==null){t.update(),L(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(M)}}const I=new Set;let we;function R(t,e){t&&t.i&&(I.delete(t),t.i(e))}function Y(t,e,n,s){if(t&&t.o){if(I.has(t))return;I.add(t),we.c.push(()=>{I.delete(t),s&&(n&&t.d(1),s())}),t.o(e)}else s&&s()}function ce(t){t&&t.c()}function F(t,e,n,s){const{fragment:r,on_mount:i,on_destroy:c,after_update:a}=t.$$;r&&r.m(e,n),s||M(()=>{const l=i.map(le).filter(_e);c?c.push(...l):L(l),t.$$.on_mount=[]}),a.forEach(M)}function K(t,e){const n=t.$$;n.fragment!==null&&(L(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ke(t,e){t.$$.dirty[0]===-1&&(S.push(t),$e(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function V(t,e,n,s,r,i,c,a=[-1]){const l=G;T(t);const u=t.$$={fragment:null,ctx:null,props:i,update:P,not_equal:r,bound:te(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:te(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};c&&c(u.root);let o=!1;if(u.ctx=n?n(t,e.props||{},(f,h,...E)=>{const _=E.length?E[0]:h;return u.ctx&&r(u.ctx[f],u.ctx[f]=_)&&(!u.skip_bound&&u.bound[f]&&u.bound[f](_),o&&ke(t,f)),h}):[],u.update(),o=!0,L(u.before_update),u.fragment=s?s(u.ctx):!1,e.target){if(e.hydrate){const f=ye(e.target);u.fragment&&u.fragment.l(f),f.forEach(y)}else u.fragment&&u.fragment.c();e.intro&&R(t.$$.fragment),F(t,e.target,e.anchor,e.customElement),oe()}T(l)}class W{$destroy(){K(this,1),this.$destroy=P}$on(e,n){const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{const r=s.indexOf(n);r!==-1&&s.splice(r,1)}}$set(e){this.$$set&&!he(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Pe(t){let e,n;return{c(){e=p("a"),n=j("Login"),d(e,"href",t[0])},m(s,r){g(s,e,r),m(e,n)},p:P,i:P,o:P,d(s){s&&y(e)}}}const Ee="ae7bb19fe4ae439f85994652dc206122",Se="https://playlist.thomasmaclean.be",Te="https://accounts.spotify.com/authorize",Le="token",Ne="playlist-modify-public";function Oe(t){return[`${Te}?client_id=${Ee}&redirect_uri=${Se}&response_type=${Le}&scope=${Ne}`]}class Ae extends W{constructor(e){super(),V(this,e,Oe,Pe,D,{})}}const ae=t=>{const n=new URLSearchParams(t.substr(1)).get("access_token");return console.log(n),n};function ie(t){let e;return{c(){e=p("div"),e.innerHTML=`<h2 class="svelte-ic62it">Generating your playlist</h2> 
      <div class="lds-ring svelte-ic62it"><div class="svelte-ic62it"></div> 
        <div class="svelte-ic62it"></div> 
        <div class="svelte-ic62it"></div> 
        <div class="svelte-ic62it"></div></div>`,d(e,"class","loading svelte-ic62it")},m(n,s){g(n,e,s)},d(n){n&&y(e)}}}function Ce(t){let e,n,s,r,i,c,a,l,u,o,f,h,E,_,$,U;return{c(){e=p("form"),n=p("div"),s=p("label"),s.textContent="Title of your playlist",r=k(),i=p("input"),c=k(),a=p("div"),l=p("label"),l.textContent="Secret message",u=k(),o=p("input"),f=k(),h=p("button"),E=j("Generate"),d(s,"for","title"),d(i,"type","text"),d(i,"id","title"),d(i,"name","title"),d(i,"class","svelte-ic62it"),d(n,"class","wrap svelte-ic62it"),d(l,"for","sentence"),d(o,"type","text"),d(o,"id","sentence"),d(o,"name","sentence"),d(o,"class","svelte-ic62it"),d(a,"class","wrap svelte-ic62it"),h.disabled=_=!t[5]||!t[2],d(e,"class","svelte-ic62it")},m(b,v){g(b,e,v),m(e,n),m(n,s),m(n,r),m(n,i),A(i,t[2]),m(e,c),m(e,a),m(a,l),m(a,u),m(a,o),A(o,t[5]),m(e,f),m(e,h),m(h,E),$||(U=[B(i,"input",t[7]),B(o,"input",t[8]),B(e,"submit",t[9])],$=!0)},p(b,v){v&4&&i.value!==b[2]&&A(i,b[2]),v&32&&o.value!==b[5]&&A(o,b[5]),v&36&&_!==(_=!b[5]||!b[2])&&(h.disabled=_)},d(b){b&&y(e),$=!1,L(U)}}}function xe(t){let e,n,s,r,i,c,a,l,u;return{c(){e=p("a"),n=j("Open playlist"),s=k(),r=p("br"),i=p("br"),c=p("br"),a=k(),l=p("iframe"),d(e,"href",t[0]),d(e,"target","_blank"),d(l,"title","playlist"),ge(l,"border-radius","12px"),ne(l.src,u="https://open.spotify.com/embed/playlist/"+t[1]+"?utm_source=generator")||d(l,"src",u),d(l,"width","100%"),d(l,"height","380"),d(l,"frameborder","0"),l.allowFullscreen=!0,d(l,"allow","autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture")},m(o,f){g(o,e,f),m(e,n),g(o,s,f),g(o,r,f),g(o,i,f),g(o,c,f),g(o,a,f),g(o,l,f)},p(o,f){f&1&&d(e,"href",o[0]),f&2&&!ne(l.src,u="https://open.spotify.com/embed/playlist/"+o[1]+"?utm_source=generator")&&d(l,"src",u)},d(o){o&&y(e),o&&y(s),o&&y(r),o&&y(i),o&&y(c),o&&y(a),o&&y(l)}}}function Ie(t){let e,n,s=t[4]&&ie();function r(a,l){return a[3]?xe:Ce}let i=r(t),c=i(t);return{c(){e=p("section"),s&&s.c(),n=k(),c.c()},m(a,l){g(a,e,l),s&&s.m(e,null),m(e,n),c.m(e,null)},p(a,[l]){a[4]?s||(s=ie(),s.c(),s.m(e,n)):s&&(s.d(1),s=null),i===(i=r(a))&&c?c.p(a,l):(c.d(1),c=i(a),c&&(c.c(),c.m(e,null)))},i:P,o:P,d(a){a&&y(e),s&&s.d(),c.d()}}}const je="https://api.spotify.com/v1/search";function Re(t,e,n){let s="",r="",i="",c=!1,a=!1,l="";const u=_=>_.replace(/[^a-zA-Z]/g,""),o=async()=>{n(4,a=!0);const _=ae(document.location.hash),$=l.split(" ");if(_){const v=(await(await fetch("https://api.spotify.com/v1/me",{headers:{Authorization:`Bearer ${_}`}})).json()).id,Z=new Headers;Z.append("Authorization",`Bearer ${_}`);const q=new URLSearchParams;q.append("type","track"),q.append("limit","50");const ue=$.map(w=>new Request(`${je}?${q}&q=track:${encodeURI(u(w))}`,{method:"GET",headers:Z})),fe=await Promise.all(ue.map(w=>fetch(w))),Q=(await Promise.all(fe.map(w=>w.json()))).map((w,z)=>{var X,ee;return((X=w.tracks.items.find(pe=>u(pe.name).toLowerCase().slice(0,Math.min(u($[z]).length,5))===u($[z]).toLowerCase().slice(0,Math.min(u($[z]).length,5))))==null?void 0:X.uri)||((ee=w.tracks.items[0])==null?void 0:ee.uri)||"1VypWHiTxUHNJKYNY6pY9n"});console.log(Q);const N=await(await fetch(`https://api.spotify.com/v1/users/${v}/playlists`,{method:"POST",headers:{Authorization:`Bearer ${_}`,"Content-Type":"application/json"},body:JSON.stringify({name:i,description:"A playlist created with Vite + Svelte",public:!0})})).json();console.log(N),n(1,r=N.id);const de=N.uri;n(0,s=de),N.external_urls.spotify,await(await fetch(`https://api.spotify.com/v1/users/${v}/playlists/${r}/tracks`,{method:"POST",headers:{Authorization:`Bearer ${_}`,"Content-Type":"application/json"},body:JSON.stringify({uris:Q})})).json(),setTimeout(()=>{n(4,a=!1),n(3,c=!0)},3e3)}};function f(){i=this.value,n(2,i)}function h(){l=this.value,n(5,l)}return[s,r,i,c,a,l,o,f,h,_=>{_.preventDefault(),o()}]}class Ue extends W{constructor(e){super(),V(this,e,Re,Ie,D,{})}}function qe(t){let e,n;return e=new Ae({}),{c(){ce(e.$$.fragment)},m(s,r){F(e,s,r),n=!0},i(s){n||(R(e.$$.fragment,s),n=!0)},o(s){Y(e.$$.fragment,s),n=!1},d(s){K(e,s)}}}function ze(t){let e,n;return e=new Ue({}),{c(){ce(e.$$.fragment)},m(s,r){F(e,s,r),n=!0},i(s){n||(R(e.$$.fragment,s),n=!0)},o(s){Y(e.$$.fragment,s),n=!1},d(s){K(e,s)}}}function Be(t){let e,n,s,r,i,c,a;const l=[ze,qe],u=[];function o(f,h){return f[0]?0:1}return i=o(t),c=u[i]=l[i](t),{c(){e=p("main"),n=p("h1"),n.textContent="Generate your Playlist with a secret message",s=k(),r=p("div"),c.c(),d(n,"class","svelte-1nh7t5c"),d(r,"class","card")},m(f,h){g(f,e,h),m(e,n),m(e,s),m(e,r),u[i].m(r,null),a=!0},p:P,i(f){a||(R(c),a=!0)},o(f){Y(c),a=!1},d(f){f&&y(e),u[i].d()}}}function He(t){return[ae(document.location.hash)]}class Je extends W{constructor(e){super(),V(this,e,He,Be,D,{})}}new Je({target:document.getElementById("app")});
